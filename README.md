# ğŸ¨ ImgRouter

> **ä¸‰åˆä¸€å›¾åƒç”Ÿæˆ API ä¸­è½¬æœåŠ¡** - ä¸€ä¸ªæ¥å£ï¼Œå¤šæ¸ é“å›¾åƒç”Ÿæˆ

[![Deno](https://img.shields.io/badge/Deno-1.x-000000?logo=deno)](https://deno.land/)
[![Docker](https://img.shields.io/badge/Docker-Ready-2496ED?logo=docker)](https://www.docker.com/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

## âœ¨ ç‰¹æ€§

- ğŸ”€ **æ™ºèƒ½è·¯ç”±** - æ ¹æ® API Key æ ¼å¼è‡ªåŠ¨è¯†åˆ«å¹¶åˆ†å‘åˆ°å¯¹åº”æ¸ é“
- ğŸš€ **ä¸‰æ¸ é“æ”¯æŒ** - ç«å±±å¼•æ“ã€Gitee (æ¨¡åŠ›æ–¹èˆŸ)ã€ModelScope (é­”å¡”)
- ğŸ”Œ **OpenAI å…¼å®¹** - å®Œå…¨å…¼å®¹ `/v1/chat/completions` æ¥å£æ ¼å¼
- ğŸ“¡ **æµå¼å“åº”** - æ”¯æŒ SSE æµå¼è¾“å‡º
- ğŸ³ **Docker éƒ¨ç½²** - å¼€ç®±å³ç”¨çš„å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ
- ğŸ“ **è¯¦ç»†æ—¥å¿—** - å®Œæ•´çš„è¯·æ±‚/å“åº”æ—¥å¿—è®°å½•

## ğŸ—ï¸ æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®¢æˆ·ç«¯è¯·æ±‚                              â”‚
â”‚              POST /v1/chat/completions                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   API Key æ£€æµ‹å™¨                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ms-*        â”‚ UUID æ ¼å¼       â”‚ 30-60ä½å­—æ¯æ•°å­—      â”‚    â”‚
â”‚  â”‚ â†’ ModelScopeâ”‚ â†’ VolcEngine    â”‚ â†’ Gitee             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼           â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚VolcEngineâ”‚ â”‚  Gitee   â”‚ â”‚ModelScopeâ”‚
    â”‚ (ç«å±±)   â”‚ â”‚(æ¨¡åŠ›æ–¹èˆŸ)â”‚ â”‚  (é­”å¡”)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šDocker Compose (æ¨è)

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/img-router.git
cd img-router

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### æ–¹å¼äºŒï¼šDocker ç›´æ¥è¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t img-router .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name img-router-proxy \
  -p 10001:10001 \
  -v ./data/logs:/var/log \
  img-router
```

### æ–¹å¼ä¸‰ï¼šæœ¬åœ°å¼€å‘

```bash
# å®‰è£… Deno (å¦‚æœæœªå®‰è£…)
# Windows: irm https://deno.land/install.ps1 | iex
# macOS/Linux: curl -fsSL https://deno.land/install.sh | sh

# å¼€å‘æ¨¡å¼ (è‡ªåŠ¨é‡è½½)
deno task dev

# ç”Ÿäº§æ¨¡å¼
deno task start
```

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬è¯·æ±‚

æœåŠ¡ç›‘å¬ç«¯å£ï¼š`10001`ï¼ˆå¯é€šè¿‡ `PORT` ç¯å¢ƒå˜é‡é…ç½®ï¼‰

```bash
curl -X POST http://localhost:10001/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "doubao-seedream-4-0-250828",
    "messages": [
      {
        "role": "user",
        "content": "ä¸€åªå¯çˆ±çš„çŒ«å’ªåœ¨é˜³å…‰ä¸‹æ‰“ç›¹"
      }
    ],
    "size": "1024x1024"
  }'
```

### å¸¦å‚è€ƒå›¾ç‰‡çš„è¯·æ±‚

```bash
curl -X POST http://localhost:10001/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "doubao-seedream-4-0-250828",
    "messages": [
      {
        "role": "user",
        "content": [
          {"type": "text", "text": "å°†è¿™å¼ å›¾ç‰‡è½¬æ¢ä¸ºæ°´å½©ç”»é£æ ¼"},
          {"type": "image_url", "image_url": {"url": "https://example.com/image.jpg"}}
        ]
      }
    ]
  }'
```

### æµå¼å“åº”

```bash
curl -X POST http://localhost:10001/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "doubao-seedream-4-0-250828",
    "messages": [{"role": "user", "content": "ç¾ä¸½çš„é£æ™¯"}],
    "stream": true
  }'
```

## ğŸ”‘ API Key æ ¼å¼

| æ¸ é“ | API Key æ ¼å¼ | ç¤ºä¾‹ |
|------|-------------|------|
| **ç«å±±å¼•æ“** | UUID æ ¼å¼ | `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx` |
| **Gitee** | 30-60ä½å­—æ¯æ•°å­— | `abc123def456...` |
| **ModelScope** | ä»¥ `ms-` å¼€å¤´ | `ms-xxxxxxxxxx` |

> ğŸ’¡ ç³»ç»Ÿä¼šæ ¹æ® API Key æ ¼å¼è‡ªåŠ¨è¯†åˆ«æ¸ é“ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®š

## âš™ï¸ é…ç½®

### ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `PORT` | æœåŠ¡ç›‘å¬ç«¯å£ | `10001` |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« (DEBUG/INFO/WARN/ERROR) | `INFO` |

### æ¸ é“é»˜è®¤æ¨¡å‹

| æ¸ é“ | é»˜è®¤æ¨¡å‹ |
|------|---------|
| ç«å±±å¼•æ“ | `doubao-seedream-4-0-250828` |
| Gitee | `z-image-turbo` |
| ModelScope | `Tongyi-MAI/Z-Image-Turbo` |

## ğŸ“ é¡¹ç›®ç»“æ„

```
img-router/
â”œâ”€â”€ main.ts              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ logger.ts            # æ—¥å¿—æ¨¡å—
â”œâ”€â”€ deno.json            # Deno é…ç½®
â”œâ”€â”€ Dockerfile           # Docker é•œåƒå®šä¹‰
â”œâ”€â”€ docker-compose.yml   # Docker Compose ç¼–æ’
â”œâ”€â”€ .dockerignore        # Docker å¿½ç•¥æ–‡ä»¶
â””â”€â”€ data/
    â”œâ”€â”€ logs/            # æ—¥å¿—æ–‡ä»¶ç›®å½•
    â””â”€â”€ app/             # åº”ç”¨æ•°æ®ç›®å½•
```

## ğŸ“ æ—¥å¿—

æ—¥å¿—æ–‡ä»¶å­˜å‚¨åœ¨ `./data/logs/` ç›®å½•ä¸‹ï¼ŒæŒ‰æ—¥æœŸå‘½åï¼š
- `app-2024-01-01.log`
- `app-2024-01-02.log`
- ...

æ—¥å¿—å†…å®¹åŒ…æ‹¬ï¼š
- è¯·æ±‚/å“åº”è®°å½•
- æ¸ é“è·¯ç”±ä¿¡æ¯
- å®Œæ•´ Prompt è®°å½•
- å›¾ç‰‡ç”ŸæˆçŠ¶æ€
- é”™è¯¯è¯¦æƒ…

## ğŸ”§ å¼€å‘

```bash
# æ ¼å¼åŒ–ä»£ç 
deno fmt

# ä»£ç æ£€æŸ¥
deno lint

# ç±»å‹æ£€æŸ¥
deno check main.ts
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

<p align="center">
  Made with â¤ï¸ by ImgRouter Team
</p>